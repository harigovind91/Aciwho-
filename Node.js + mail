const nodemailer = require('nodemailer');

// ईमेल कॉन्फ़िगरेशन (आपको नोटिफिकेशन भेजने के लिए)
const transporter = nodemailer.createTransport({
  service: 'gmail',
  auth: { user: 'admin@aciwho.org', pass: 'your-password' }
});

// पेमेंट कन्फर्मेशन रूट
app.post('/payment-success', async (req, res) => {
  const { payment_id, amount, donor_email, campaign_id } = req.body;

  // 1. डेटाबेस में रिकॉर्ड सेव करना
  await db.collection('transactions').insertOne({ payment_id, amount, campaign_id, date: new Date() });

  // 2. आपको (CEO) और डोनर को ईमेल भेजना
  const mailOptions = {
    from: 'Aciwho Welfare Foundation',
    to: 'harigovind_ceo@aciwho.org', // आपकी ईमेल आईडी
    subject: 'New Donation Received!',
    text: `बधाई हो! ₹${amount} का नया डोनेशन प्राप्त हुआ है। पेमेंट आईडी: ${payment_id}`
  };

  transporter.sendMail(mailOptions);
  res.status(200).send("Record Updated & Mail Sent");
});
